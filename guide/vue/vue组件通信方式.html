<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/qiaolingyan/blog-img@master/vuepress/logo.4rs1px4f8j60.jpg"><title>Vue 组件通信 | qiao</title><meta name="description" content="happy day"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.19">
    <link rel="preload" href="/assets/js/runtime~app.89d2221a.js" as="script"><link rel="preload" href="/assets/css/styles.55340b42.css" as="style"><link rel="preload" href="/assets/js/640.35c7ecf5.js" as="script"><link rel="preload" href="/assets/js/app.983a575d.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.55340b42.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/" class=""><img class="logo" src="https://cdn.jsdelivr.net/gh/qiaolingyan/blog-img@master/vuepress/logo.4rs1px4f8j60.jpg" alt="qiao"><span class="site-name can-hide">qiao</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="指南"><span class="title">指南</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="指南"><span class="title">指南</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/guide/js/" class="nav-link" aria-label="Js"><!--[--><!--]--> Js <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/webpack/" class="nav-link" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/vue/" class="nav-link router-link-active" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/react/" class="nav-link" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/SSR/" class="nav-link" aria-label="SSR"><!--[--><!--]--> SSR <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/nodejs/" class="nav-link" aria-label="NodeJs"><!--[--><!--]--> NodeJs <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/algorithm/" class="nav-link" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/CICD/" class="nav-link" aria-label="自动化部署"><!--[--><!--]--> 自动化部署 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/other/" class="nav-link" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a href="/interview/" class="nav-link" aria-label="面试"><!--[--><!--]--> 面试 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="分类"><span class="title">分类</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="分类"><span class="title">分类</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/source/basis/" class="nav-link" aria-label="前端基础建设与架构"><!--[--><!--]--> 前端基础建设与架构 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a href="/link/" class="nav-link" aria-label="Link"><!--[--><!--]--> Link <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="指南"><span class="title">指南</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="指南"><span class="title">指南</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/guide/js/" class="nav-link" aria-label="Js"><!--[--><!--]--> Js <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/webpack/" class="nav-link" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/vue/" class="nav-link router-link-active" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/react/" class="nav-link" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/SSR/" class="nav-link" aria-label="SSR"><!--[--><!--]--> SSR <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/nodejs/" class="nav-link" aria-label="NodeJs"><!--[--><!--]--> NodeJs <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/algorithm/" class="nav-link" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/CICD/" class="nav-link" aria-label="自动化部署"><!--[--><!--]--> 自动化部署 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/guide/other/" class="nav-link" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a href="/interview/" class="nav-link" aria-label="面试"><!--[--><!--]--> 面试 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="分类"><span class="title">分类</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="分类"><span class="title">分类</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/source/basis/" class="nav-link" aria-label="前端基础建设与架构"><!--[--><!--]--> 前端基础建设与架构 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a href="/link/" class="nav-link" aria-label="Link"><!--[--><!--]--> Link <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><section class="sidebar-group"><p class="sidebar-heading active">Vue</p><ul class=""><li><!--[--><a href="/guide/vue/Vue%E9%9D%A2%E8%AF%95%E9%A2%98.html" class="nav-link sidebar-link" aria-label="Vue 面试题"><!--[--><!--]--> Vue 面试题 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/vue/VueRouter.html" class="nav-link sidebar-link" aria-label="VueRouter-基础"><!--[--><!--]--> VueRouter-基础 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/vue/VueRouter(%E4%BA%8C).html" class="nav-link sidebar-link" aria-label="VueRouter-原理"><!--[--><!--]--> VueRouter-原理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/vue/vue%E5%93%8D%E5%BA%94%E5%BC%8F.html" class="nav-link sidebar-link" aria-label="Vue 响应式原理"><!--[--><!--]--> Vue 响应式原理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-link active" aria-label="Vue 组件通信"><!--[--><!--]--> Vue 组件通信 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#vue组件通信方式" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="vue组件通信方式"><!--[--><!--]--> vue组件通信方式 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#_1-vue-组件通信方式" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="1. vue 组件通信方式"><!--[--><!--]--> 1. vue 组件通信方式 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#_2-手写实现-eventbus" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="2. 手写实现 EventBus"><!--[--><!--]--> 2. 手写实现 EventBus <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#_3-为什么要用-vuex" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="3. 为什么要用 Vuex"><!--[--><!--]--> 3. 为什么要用 Vuex <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#_4-vuex-和-localstorage-的区别" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="4. vuex 和 localStorage 的区别"><!--[--><!--]--> 4. vuex 和 localStorage 的区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#_5-vuex-的原理" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="5. vuex 的原理"><!--[--><!--]--> 5. vuex 的原理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/vue/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html#_6-子组件可以直接改变父组件的数据吗-说明原因" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="6. 子组件可以直接改变父组件的数据吗，说明原因"><!--[--><!--]--> 6. 子组件可以直接改变父组件的数据吗，说明原因 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/guide/vue/vuex.html" class="nav-link sidebar-link" aria-label="Vuex"><!--[--><!--]--> Vuex <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/vue/%E8%99%9A%E6%8B%9FDOM.html" class="nav-link sidebar-link" aria-label="Virtual DOM"><!--[--><!--]--> Virtual DOM <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/vue/diff%E7%AE%97%E6%B3%95.html" class="nav-link sidebar-link" aria-label="Diff 算法"><!--[--><!--]--> Diff 算法 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/vue/封装vue组件库" class="nav-link sidebar-link" aria-label="封装vue组件库"><!--[--><!--]--> 封装vue组件库 <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h3 id="vue组件通信方式"><a class="header-anchor" href="#vue组件通信方式">#</a> vue<strong>组件通信方式</strong></h3><h3 id="_1-vue-组件通信方式"><a class="header-anchor" href="#_1-vue-组件通信方式">#</a> 1. vue 组件通信方式</h3><p>Vue 组件通信主要指以下 3 类通信：<strong>父子组件通信、隔代组件通信、兄弟组件通信</strong></p><ul><li><p><strong>props / emit</strong> -- <strong>父子组件通信</strong></p><p>子组件不可修改父组件 props 传过来的值</p></li><li><p><strong>ref 与 $parent / $children</strong> -- <strong>父子组件通信</strong></p><p>ref : 如果在普通的 DOM 元素上使用，引用指向的就是 DOM 元素，如果用在子组件上，引用就指向组件实例</p><p>$parent / $children : 访问 父 / 子 实例</p></li><li><p><strong>EventBus ($emit / $on)</strong> -- <strong>父子、隔代、兄弟组件通信通用</strong></p><p>这种方法通过一个空的 Vue 实例作为中央事件总线（事件中心），用它来触发事件和监听事件，从而实现任何组件间的通信，包括 父子、隔代、兄弟</p></li><li><p><strong>$attrs / $listeners</strong> -- <strong>隔代组件通信</strong></p><p>$attrs ： 包含了父作用域中不被 prop 所识别（且获取）的特性绑定（class 和 style 除外）。当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定（class 和 style 除外），并且可以通过 v-bind=&quot;$attrs&quot; 传入内部组件。通常配合 inheritAttrs 选项一起使用</p><p>$listeners : 包含了父作用域中（不含 .native修饰器）v-on 事件监听器。它可以通过 v-on=&quot;$listeners&quot; 传入内部组件</p></li><li><p><strong>provide / inject</strong> -- <strong>隔代组件通信</strong></p><p>祖先组件通过 provider 来提供变量，然后在子孙组件中通过 inject 来注入变量。</p><p>provide / inject API 主要解决了跨级组件间的通信，不过它的使用场景，主要是子组件获取上级组件的状态，跨级组件间建立了一种主动提供与依赖注入的关系</p></li><li><p><strong>Vuex</strong> -- <strong>父子、隔代、兄弟组件通信</strong></p><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。每一个 Vuex 应用的核心就是 store（仓库）。“store&quot; 基本上就是一个容器，它包含着你的应用中大部分的状态（state）。</p><p>Vuex 的状态存储是响应式的。当 Vue 组件从 store 中读取状态的时候，若 store 中的状态发生变化，那么相应的组件也会相应地得到高效更新。</p><p>改变 store 中的状态的唯一途径就是显式地提交（commit）mutation。这样使得我们可以方便地跟踪每一个状态的变化。</p></li></ul><h3 id="_2-手写实现-eventbus"><a class="header-anchor" href="#_2-手写实现-eventbus">#</a> 2. 手写实现 EventBus</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// {&#39;clicl&#39;:[fn1,fn2], &#39;change&#39;:[fn1]}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">$on</span><span class="token punctuation">(</span><span class="token parameter">eventType<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">$emit</span><span class="token punctuation">(</span><span class="token parameter">eventType<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">handler</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">handler</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">$off</span><span class="token punctuation">(</span><span class="token parameter">eventType<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  	<span class="token keyword">const</span> cbs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span>
  	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>cbs<span class="token punctuation">)</span> <span class="token keyword">return</span>  <span class="token comment">// 如果不存在直接返回</span>
  	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  		<span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 没有指定回调，移除该事件所有回调</span>
  		<span class="token keyword">return</span>
  	<span class="token punctuation">}</span>
  	<span class="token comment">// 移除指定的回调</span>
  	<span class="token keyword">let</span> cb
  	<span class="token keyword">let</span> i <span class="token operator">=</span> cbs<span class="token punctuation">.</span>length
  	<span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  		cb <span class="token operator">=</span> cbs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span>
  		<span class="token keyword">if</span><span class="token punctuation">(</span>cb <span class="token operator">===</span> fn <span class="token operator">||</span> cb<span class="token punctuation">.</span>fn <span class="token operator">===</span> fn<span class="token punctuation">)</span><span class="token punctuation">{</span>
  			cbs<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
  			<span class="token keyword">break</span>
  		<span class="token punctuation">}</span>
  	<span class="token punctuation">}</span>
  	
  <span class="token punctuation">}</span>
  
  <span class="token function">$once</span><span class="token punctuation">(</span><span class="token parameter">eventType<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  	<span class="token keyword">const</span> <span class="token function-variable function">on</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$off</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span>on<span class="token punctuation">)</span>
  		<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>
  	<span class="token punctuation">}</span>
  	on<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn
  	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span>on<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h3 id="_3-为什么要用-vuex"><a class="header-anchor" href="#_3-为什么要用-vuex">#</a> 3. 为什么要用 Vuex</h3><p>由于传参的方法对于多层嵌套的组件将会非常繁琐，并且对于兄弟组件间的状态传递无能为力。我们经常会采用父子组件直接引用或者通过事件来变更和同步状态的多份拷贝。以上的这些模式非常脆弱，通常会导致代码无法维护。</p><p>所以我们需要把组件的共享状态抽取出来，以一个全局单例模式管理。在这种模式下，我们的组件树构成了一个巨大的“视图”，不管在树的哪个位置，任何组件都能获取状态或者触发行为！</p><p>另外，通过定义和隔离状态管理中的各种概念并强制遵守一定的规则，我们的代码将会变得更结构化且易维护。</p><h3 id="_4-vuex-和-localstorage-的区别"><a class="header-anchor" href="#_4-vuex-和-localstorage-的区别">#</a> 4. vuex 和 localStorage 的区别</h3><p><strong>最重要的区别</strong>：</p><ul><li>vuex 存储在内存</li><li>localStorage 则以文件的方式存储在本地，localStorage 只能存储字符串类型的数据，存储对象需要 JSON 的 stringfy 和 parse 方法进行处理。读取内存比读取硬盘速度要快</li></ul><p>应用场景：</p><ul><li>vuex 是一个专为 vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。vuex 用于组件之间的传值。</li><li>localStorage 是本地存储，是将数据存储到浏览器的方法，一般是在跨页面传递数据时使用</li><li>vuex 能做到数据的响应式，localStorage 不能</li></ul><p>永久性:</p><ul><li>刷新页面时 vuex 存储的值会丢失</li><li>localStorage 不会</li></ul><h3 id="_5-vuex-的原理"><a class="header-anchor" href="#_5-vuex-的原理">#</a> 5. vuex 的原理</h3><p>vuex 为 vue Components 建立起了一个完整的生态圈，包括开发中的 API 调用一环。</p><p><img src="/assets/img/vuex.c2bcd672.png" alt="img"></p><h4 id="_5-1-核心流程的主要功能"><a class="header-anchor" href="#_5-1-核心流程的主要功能">#</a> 5.1 核心流程的主要功能：</h4><ul><li><ol><li>Vue Components 是我们的 vue 组件，组件会触发 （dispatch）一些事件或动作，也就是图中的 Actions</li><li>我们在组件中发出的动作，肯定是想获取或者改变数据的，但是在 vuex 中，数据是集中管理的，我们不能直接去更改数据，所以会把这个动作提交 （commit）到 Mutations 中</li><li>然后 Mutations 就去改变 （Mutate）State 中的数据</li><li>当 State 中的数据被改变之后，就会重新渲染（Render）到 Vue Components 中去，组件展示更新后的数据，完成一个流程。</li></ol></li></ul><h4 id="_5-2-各模块在核心流程中的主要功能"><a class="header-anchor" href="#_5-2-各模块在核心流程中的主要功能">#</a> 5.2 各模块在核心流程中的主要功能</h4><ul><li><strong>Vue Components</strong>: Vue组件。Html 页面上，负责接收用户操作等交互行为，执行 dispatch 方法触发 action 进行回应</li><li><strong>dispatch</strong>：操作行为触发方法，是唯一能执行action的方法</li><li><strong>actions</strong>：操作行为处理模块。负责处理 Vue Components 接收到的所有交互行为。包含同步/异步操作，支持多个同名方法，按照注册的顺序依次触发。向后台 API 请求的操作就在这个模块中进行，包括触发其他 action 以及提交 mutation 的操作。该模块提供了 Promise 的封装，以支持 action 的链式触发</li><li><strong>commit</strong>：状态改变提交操作方法。对 mutation 进行提交，是唯一能执行 mutation 的方法</li><li><strong>mutations</strong> :状态改变操作方法。是 Vuex 修改 state 的唯一推荐方法，其他修改方式在严格模式下将会报错。该方法只能进行同步操作，且方法名只能全局唯一。操作之中会有一些 hook 暴露出来，以进行 state 的监控等。</li><li><strong>state</strong>：页面状态管理容器对象。集中存储 Vue Components 中的 data 对象的零散数据，全局唯一，以进行统一的状态管理。页面显示所需的数据从该对象中进行读取，利用 Vue 的细粒度数据响应机制来进行高效的状态更新。</li><li><strong>getters</strong>：state 对象读取方法。图中没有单独列出该模块，应该被包含在了 render 中，Vue Components 通过该方法读取全局state 对象</li></ul><h3 id="_6-子组件可以直接改变父组件的数据吗-说明原因"><a class="header-anchor" href="#_6-子组件可以直接改变父组件的数据吗-说明原因">#</a> 6. 子组件可以直接改变父组件的数据吗，说明原因</h3><p>不可以。</p><p><strong>主要是为了维护父子组件的单向数据流</strong></p><p>每次父级组件发生更新时，子组件中所有的 prop 都将会刷新为最新的值。</p><p>如果这样做了，Vue 会在浏览器的控制台中发出警告。</p><p>Vue 提倡单向数据流，即父级 props 的更新会流向子组件，但是反过来则不行。这是为了防止意外的改变父组件状态，使得应用的数据流变得难以理解，导致数据流混乱。如果破坏了单向数据流，当应用复杂时， debug 的成本会非常高。</p><p>只能通过 $emit 派发一个自定义事件，父组件接收到后，由父组件修改。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">7/2/2021, 5:45:28 PM</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/guide/vue/vue%E5%93%8D%E5%BA%94%E5%BC%8F.html" class="nav-link" aria-label="Vue 响应式原理"><!--[--><!--]--> Vue 响应式原理 <!--[--><!--]--></a></span><span class="next"><a href="/guide/vue/vuex.html" class="nav-link" aria-label="Vuex"><!--[--><!--]--> Vuex <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.89d2221a.js" defer></script><script src="/assets/js/640.35c7ecf5.js" defer></script><script src="/assets/js/app.983a575d.js" defer></script>
  </body>
</html>
