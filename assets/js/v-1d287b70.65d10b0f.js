(self.webpackChunkvuepress_blog=self.webpackChunkvuepress_blog||[]).push([[825],{7454:(s,n,a)=>{"use strict";a.r(n),a.d(n,{data:()=>e});const e={key:"v-1d287b70",path:"/guide/other/gitHooks.html",title:"git hooks",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"介绍",slug:"介绍",children:[]},{level:2,title:"简单测试",slug:"简单测试",children:[]},{level:2,title:"Husky",slug:"husky",children:[{level:3,title:"使用 husky ，Git Hooks 不生效",slug:"使用-husky-git-hooks-不生效",children:[]}]},{level:2,title:"lint-staged",slug:"lint-staged",children:[]}],filePathRelative:"guide/other/gitHooks.md",git:{updatedTime:1624433052e3,contributors:[]}}},7879:(s,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>p});const e=(0,a(6252).uE)('<h1 id="git-hooks"><a class="header-anchor" href="#git-hooks">#</a> git hooks</h1><h2 id="介绍"><a class="header-anchor" href="#介绍">#</a> 介绍</h2><ol><li>Git Hook 也称之为 git 钩子，每个钩子都对应一个任务</li><li>通过 shell 脚本可以编写钩子任务触发时要具体执行的操作</li></ol><h2 id="简单测试"><a class="header-anchor" href="#简单测试">#</a> 简单测试</h2><ol><li><p>目录查找文件</p><p><code>.git/hooks/</code></p></li><li><p>复制粘贴一份 <code>pre-commit.sample</code>文件，删除后缀</p></li><li><p>打开 <code>pre-commit</code> 文件编辑脚本</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token number">222</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>git commit 测试</p></li></ol><h2 id="husky"><a class="header-anchor" href="#husky">#</a> Husky</h2><ol><li><p>安装</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i husky\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>修改配置</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json 文件添加 husky 字段</span>\n<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>\n    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span><span class="token string">&quot;eslint ./index.js&quot;</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run test&quot;</span>\n    <span class="token punctuation">}</span>\n <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li><li><p>在commit之前进行 eslint 校验</p></li><li><p>eslint 代码检查过后进行格式化，添加进暂存区，使用 lint-staged</p></li></ol><h3 id="使用-husky-git-hooks-不生效"><a class="header-anchor" href="#使用-husky-git-hooks-不生效">#</a> 使用 husky ，Git Hooks 不生效</h3><p>原因：版本问题</p><p>解决：回退版本</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i husky@4.3.8 -D\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="lint-staged"><a class="header-anchor" href="#lint-staged">#</a> lint-staged</h2><ol><li><p>安装</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> lint-staged\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>修改配置</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json 文件添加 lint-staged 字段</span>\n<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>\n    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span><span class="token string">&quot;eslint ./index.js&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;precommit&quot;</span><span class="token operator">:</span><span class="token string">&quot;lint-staged&quot;</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">// &quot;pre-commit&quot;: &quot;npm run test&quot;</span>\n       <span class="token property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run precommit&quot;</span>\n    <span class="token punctuation">}</span>\n <span class="token punctuation">}</span>\n<span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;*.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token string">&quot;eslint&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;git add&quot;</span>\n    <span class="token punctuation">]</span>\n <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ol>',13),p={render:function(s,n){return e}}}}]);